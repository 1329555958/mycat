<?xml version="1.0"?>
<!DOCTYPE mycat:schema SYSTEM "schema.dtd">
<mycat:schema xmlns:mycat="http://io.mycat/">

    <schema name="dpm" checkSQLschema="false" sqlMaxLimit="100">
        <table name="DUAL" dataNode="dn1"/>
        <table name="dbajobconf" primaryKey="JOBNAME" dataNode="dn1"/>
        <table name="dbajoblog" primaryKey="JOBID" dataNode="dn1"/>
        <table name="t_act_account_titile" primaryKey="TITLE_SEQ_NO" dataNode="dn1"/>
        <table name="t_dpm_account_crl_def" dataNode="dn1"/>
        <table name="t_dpm_account_entry" primaryKey="ENTRY_SEQ_NO" dataNode="dn1"/>
        <table name="t_dpm_buffer_detail" primaryKey="BUFFER_DETAIL_ID" dataNode="dn1"/>

        <table name="t_dpm_buffer_detail_log" primaryKey="BUFFER_DETAIL_ID" dataNode="dn1,dn2"
               rule="rule-transaction-no-2"/>
        <table name="t_dpm_buffer_rule" primaryKey="BUFFER_RULE_ID" dataNode="dn1,dn2" rule="rule-transaction-no-2"/>
        <table name="t_dpm_pay_transaction" primaryKey="TRANSACTION_ID" dataNode="dn1,dn2"
               rule="rule-transaction-no-2"/>
        <table name="t_dpm_subacc_fundattribute" dataNode="dn1"/>

        <table name="tb_title_daily" primaryKey="ID" dataNode="dn1"/>

        <table name="t_dpm_inner_account" primaryKey="ACCOUNT_NO" dataNode="dn1,dn2" rule="rule-account-no-2">
            <childTable name="t_dpm_inner_account_detail" primaryKey="TXN_SEQ_NO" joinKey="ACCOUNT_NO"
                        parentKey="ACCOUNT_NO"/>
        </table>

        <table name="t_dpm_outer_account" primaryKey="ACCOUNT_NO" dataNode="dn1,dn2" rule="rule-account-no-2">
            <childTable name="t_dpm_outer_account_detail" primaryKey="TXN_SEQ_NO" joinKey="ACCOUNT_NO"
                        parentKey="ACCOUNT_NO"/>
        </table>

        <table name="t_dpm_outer_account_subset" primaryKey="ACCOUNT_NO" dataNode="dn1,dn2" rule="rule-account-no-2">
            <childTable name="t_dpm_outer_account_sub_detail" primaryKey="ACCOUNT_SUBSET_LOG_ID" joinKey="ACCOUNT_NO"
                        parentKey="ACCOUNT_NO"/>
        </table>

    </schema>

    <dataNode name="dn1" dataHost="host1" database="db1"/>
    <dataNode name="dn2" dataHost="host2" database="db2"/>

    <dataHost name="host1" maxCon="1000" minCon="10" balance="0"
              writeType="0" dbType="mysql" dbDriver="native" switchType="1" slaveThreshold="100">
        <heartbeat>select user()</heartbeat>
        <writeHost host="hostM1" url="10.65.213.14:23310" user="dpmuser"
                   password="dpmuser">
        </writeHost>
    </dataHost>
    <dataHost name="host2" maxCon="1000" minCon="10" balance="0"
              writeType="0" dbType="mysql" dbDriver="native" switchType="1" slaveThreshold="100">
        <heartbeat>select user()</heartbeat>
        <writeHost host="hostM1" url="10.65.213.14:23311" user="dpmuser"
                   password="dpmuser">
        </writeHost>
    </dataHost>

</mycat:schema>